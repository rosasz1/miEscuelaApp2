{% extends "base_dashboard.html" %}

{% block title %}Panel Alumno{% endblock %}

{% block panel_title %}Bienvenido, {{ nombre }}{% endblock %}

{% block sidebar %}
<h5 class="text-center">Panel Alumno</h5>

<div class="accordion" id="sidebarAccordionAlumno">
  <div class="accordion-item">
    <h2 class="accordion-header" id="headingNotas">
      <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseNotas">
        Mis Notas
      </button>
    </h2>
    <div id="collapseNotas" class="accordion-collapse collapse" data-bs-parent="#sidebarAccordionAlumno">
      <div class="accordion-body p-2">
        <a href="{{ url_for('alumno.ver_notas') }}">📘 Ver mis notas</a>
      </div>
    </div>
  </div>

  <div class="accordion-item mt-2">
    <h2 class="accordion-header" id="headingAsistencias">
      <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseAsistencias">
        Mis Asistencias
      </button>
    </h2>
    <div id="collapseAsistencias" class="accordion-collapse collapse" data-bs-parent="#sidebarAccordionAlumno">
      <div class="accordion-body p-2">
        <a href="{{ url_for('alumno.ver_asistencias') }}">📋 Ver mis asistencias</a>
      </div>
    </div>
  </div>

  <div class="logout-container">
  <a href="{{ url_for('auth.logout') }}" class="logout-btn"> Cerrar sesión</a>
</div>
</div>
{% endblock %}

{% block content %}
<h2 class="mb-4">👋 Hola, {{ nombre }}. Este es tu panel.</h2>

<h5 class="mb-3">📅 Cronograma semanal</h5>
<table class="cronograma-table">
  <thead>
    <tr>
      <th>Hora</th>
      <th>Lunes</th>
      <th>Martes</th>
      <th>Miércoles</th>
      <th>Jueves</th>
      <th>Viernes</th>
    </tr>
  </thead>
  <tbody>
    {% set horas = [
      "07:00 - 07:45", "07:45 - 08:30", "08:30 - 09:15", "09:15 - 10:00",
      "10:15 - 11:00", "11:00 - 11:45", "11:45 - 12:30", "12:30 - 13:15"
    ] %}
    {% for hora in horas %}
    <tr>
      <td>{{ hora }}</td>
      {% for dia in ["Lunes", "Martes", "Miércoles", "Jueves", "Viernes"] %}
      <td>
        {% for h in horarios %}
          {% if h[1] == dia and h[2].strftime('%H:%M') ~ " - " ~ h[3].strftime('%H:%M') == hora %}
            {{ h[0] }}
          {% endif %}
        {% endfor %}

        {% for ex in examenes %}
          {% set dia_examen = ex[2].strftime('%A') %}
          {% set hora_examen = ex[3].strftime('%H:%M') %}
          {% if dia_examen == dia and hora_examen in hora %}
            <div><span class="text-danger fw-bold">📝 Examen: {{ ex[4] or 'sin título' }}</span></div>
          {% endif %}
        {% endfor %}
      </td>
      {% endfor %}
    </tr>
    {% endfor %}
  </tbody>
</table>
{% endblock %}

{% block bottom_panel %}
<h5 class="mt-4">📊 Últimas calificaciones</h5>
<ul>
  <li>Matemática: 8.50</li>
  <li>Historia: 7.00</li>
  <li>Lengua: 9.00</li>
</ul>
{% endblock %}
